<!-- Define the recursive template. -->
<ng-template #nodeTemplateRef let-node="node">

  <div class="node" [class.node--selected]="( node === selectedTreeNode )">
    <a (click)="selectNode( node )" class="node__value">
      {{ node.value }}
    </a>
    <div *ngIf="node.children.length" class="node__children">

      <ng-template ngFor let-child [ngForOf]="node.children">

        <!-- Invoke the recursive template. -->
        <ng-template
          [ngTemplateOutlet]="nodeTemplateRef"
          [ngTemplateOutletContext]="{ node: child }">
        </ng-template>
      </ng-template>
    </div>
  </div>

</ng-template>


<!-- Initiate the recursive template rendering. -->
<div *ngIf="nodeList; else loading">
  <ng-template
    [ngTemplateOutlet]="nodeTemplateRef"
    [ngTemplateOutletContext]="{ node: nodeList[0] }">
  </ng-template>
</div>
